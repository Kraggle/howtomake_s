import{jQuery as t}from"./src/jquery-3.5.1-min.js";import{K as e}from"./custom/K-min.js";import n from"./custom/Paths.js";export function getKeywords(n){e.extend({content:"",ignore:[],count:2,min:1,max:6,enabled:!0,alts:!1,meta:!1},n);const r=t("<div />",{html:n.content});r.find("script, link, style, iframe, noscript").remove();const o=r.text().split(/[ ]{0,}[.;:?!\n][ ]{0,}/);n.doAltTags&&r.find("img").each(((e,n)=>{const r=t(n).attr("alt");r&&o.push(r)})),n.meta&&r.find("meta[content]").each(((e,n)=>{const r=t(n).attr("content");r&&o.push(r)}));const i={};for(let t=n.min;t<=n.max;t++)i[t]={};let s=0;return e.each(o,((t,r)=>{if(r.length<4||!r.match(/\w+/))return;const o=r.split(/ \W{0,}|\W{0,} /);s+=o.length,e.each(i,((t,r)=>{t=parseInt(t),o.length>=t&&e.each(o,((i,s)=>{let a="";for(let e=i;e<t+i;e++){if(!o[e])return;a+=" "+o[e]}a=a.trim().toLowerCase();const c=a.replaceAll("’","'").match(/^[^ ]+/)[0],l=a.replaceAll("’","'").match(/[^ ]+$/)[0];if(!(a.length<3||a.match(/^(\d+|\d.+\d)$/))){if(n.enabled){if(t<3&&(e.isInArray(c,n.ignore)||e.isInArray(l,n.ignore)))return;if(t>2&&e.isInArray(c,n.ignore)&&e.isInArray(l,n.ignore))return}r[a]||(r[a]=0),r[a]++}}))}))})),n.groups={},e.each(i,((t,r)=>{n.groups[t]=[],e.each(r,((e,r)=>{r>=n.count&&n.groups[t].push({keywords:e,count:r,density:r/(s/t)*100})})),n.groups[t].sort(((t,e)=>e.count-t.count))})),n.groups}export function getSettings(e){return t.getJSON(n.ajax,{action:"get_keyword_settings",nonce:t("#keyword_nonce").val()},(function(t){convertSettings(e,t)}))}export const convertSettings=(t,e)=>{t.ignore=e.ignore_list,t.min=parseInt(e.min_words),t.max=parseInt(e.max_words),t.refresh=parseInt(e.refresh),t.count=parseInt(e.min_count),t.enabled=r(e.ignore_enabled),t.meta=r(e.meta_tags),t.alts=r(e.image_alts)};const r=t=>!0===t||"true"===t;export const filter={or:t=>"[filter]:regex(filter, ^.*("+t.split(" ").join("|")+").*$)",and:t=>"[filter]:regex(filter, ^"+t.split(" ").map((t=>`(?=.*${t})`)).join("")+".*$)",exact:t=>`[filter]:regex(filter, ^.*${t}.*$)`};